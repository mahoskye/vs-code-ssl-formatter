:PROCEDURE TestSQLParameterValidation;
/* Test SQL parameter placeholder validation;

	:DECLARE sSampleId, sStatus, nTestId;
	:DECLARE aResults, sQuery;

	/* Valid - using declared variable;
	sSampleId := "SAMPLE001";
	sQuery := "SELECT * FROM samples WHERE sample_id = ?sSampleId?";
	aResults := SQLExecute(sQuery, , , {sSampleId});

	/* Valid - using declared variable (different case in code vs placeholder);
	sStatus := "PENDING";
	sQuery := "SELECT * FROM samples WHERE status = ?sStatus?";
	aResults := SQLExecute(sQuery, , , {sStatus});

	/* INVALID - SAMPLE_ID is not declared (should be sSampleId);
	sQuery := "SELECT * FROM samples WHERE sample_id = ?SAMPLE_ID?";
	aResults := SQLExecute(sQuery);

	/* INVALID - TEST_ID is not declared (should be nTestId);
	sQuery := "SELECT * FROM tests WHERE test_id = ?TEST_ID?";
	aResults := SQLExecute(sQuery);

	/* Valid - nTestId is declared;
	nTestId := 123;
	sQuery := "SELECT * FROM tests WHERE test_id = ?nTestId?";
	aResults := SQLExecute(sQuery, , , {nTestId});

	:RETURN .T.;
:ENDPROC;

/* Global constants;
:DECLARE MAX_BATCH_SIZE, DEFAULT_STATUS;
MAX_BATCH_SIZE := 100;
DEFAULT_STATUS := "PENDING";

:PROCEDURE TestWithConstants;
/* Test SQL parameters with global constants;

	:DECLARE sQuery, aResults;

	/* Valid - using global constant;
	sQuery := "SELECT * FROM batches WHERE size <= ?MAX_BATCH_SIZE?";
	aResults := SQLExecute(sQuery, , , {MAX_BATCH_SIZE});

	/* Valid - using global constant;
	sQuery := "SELECT * FROM samples WHERE status = ?DEFAULT_STATUS?";
	aResults := SQLExecute(sQuery, , , {DEFAULT_STATUS});

	/* INVALID - NOT_DECLARED is not a valid constant or variable;
	sQuery := "SELECT * FROM samples WHERE field = ?NOT_DECLARED?";
	aResults := SQLExecute(sQuery);

	:RETURN .T.;
:ENDPROC;

:PROCEDURE TestWithParameters;
/* Test SQL parameters with procedure parameters;
	:PARAMETERS sSampleId, nBatchSize;

	:DECLARE sQuery, aResults;

	/* Valid - using procedure parameter;
	sQuery := "SELECT * FROM samples WHERE sample_id = ?sSampleId?";
	aResults := SQLExecute(sQuery, , , {sSampleId});

	/* Valid - using procedure parameter;
	sQuery := "SELECT * FROM batches WHERE size = ?nBatchSize?";
	aResults := SQLExecute(sQuery, , , {nBatchSize});

	:RETURN .T.;
:ENDPROC;
